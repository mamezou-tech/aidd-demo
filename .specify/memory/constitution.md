# Talent Management System Constitution (MVP)

## プロダクトビジョン

**タレントマネジメントシステム MVP** - 社員と組織情報の管理と検索ができるシステム

### MVP目的
- **人事**: スキルの可視化により、適切な人材配置を支援
- **マネージャー**: 配下メンバーの情報可視化により、チーム管理を効率化

### MVPスコープ
- ✅ 社員情報の登録・閲覧・検索
- ✅ スキル情報の登録・閲覧
- ✅ 組織階層の表現（シンプルな親子関係）
- ✅ 基本的な権限管理（人事 / マネージャー / 一般）
- ❌ 詳細な監査ログ（将来対応）
- ❌ 複雑な権限カスタマイズ（将来対応）
- ❌ スキル分析・レポート機能（将来対応）

## Core Principles

### I. シンプルさ優先（MVP）
- 最小限の機能で価値を提供
- 複雑な機能は後回し
- データ構造はシンプルに保つ

### II. 権限管理（簡易版）
- **人事（ADMIN）**: 全社員情報の閲覧・編集
- **マネージャー（MANAGER）**: 配下メンバーの情報閲覧のみ
- **一般社員（EMPLOYEE）**: 自身の情報閲覧のみ
- 権限は手動設定（組織階層からの自動判定は将来対応）

### III. Spec-Driven Development (NON-NEGOTIABLE)
- すべての機能は仕様 → 計画 → タスク → 実装の順で開発
- 仕様には「なぜ必要か」を明記
- テスト駆動開発を徹底

### IV. API First
- すべての機能はREST APIとして提供
- OpenAPI仕様を自動生成
- フロントエンドは将来的に追加可能な設計

## 技術スタック

### バックエンド
- **言語**: Java 17
- **フレームワーク**: Spring Boot 3.x
- **認証**: JWT (JSON Web Token)
- **データベース**: MySQL 8.x
- **ビルドツール**: Gradle

### 開発環境
- **コンテナ**: Docker + Docker Compose
- **開発環境**: Dev Container
- **ドキュメント**: OpenAPI/Swagger UI

## データ設計原則（MVP）

### 最小限のエンティティ
- **User**: 既存（認証用）+ ロール追加
- **Employee**: 社員情報（氏名、所属組織ID、役職）
- **Organization**: 組織情報（名前、親組織ID）
- **Skill**: スキル定義（名前、カテゴリ）
- **EmployeeSkill**: 社員スキル（社員ID、スキルID、レベル）

### 簡素化した設計
- 組織階層: 親組織IDのみ（深い階層は考慮しない）
- スキルレベル: 1-5の数値のみ（詳細な定義は将来対応）
- 権限: User.role（ADMIN/MANAGER/EMPLOYEE）で管理
- マネージャー配下: Employee.managerId で表現

### 削除した要素
- ❌ 詳細なアクセスログ
- ❌ 監査テーブル
- ❌ スキルカテゴリの階層構造
- ❌ 社員の履歴管理
- ❌ 複雑な権限カスタマイズ

## 開発ワークフロー

### 機能追加プロセス
1. **仕様作成**: `q speckit specify "<機能要件>"`
2. **計画策定**: `q speckit plan`
3. **タスク分解**: `q speckit tasks`
4. **実装**: タスク単位で実装 → テスト → コミット
5. **検証**: `q speckit checklist` で完了確認

## Git管理ルール（トランクベース開発）

### ブランチ戦略
- **メインブランチ**: `main`（常にデプロイ可能な状態を維持）
- **作業ブランチ**: 短命フィーチャーブランチ（数時間〜1日以内）

### ブランチ命名規則
以下のプレフィックスを使用：
- `feature/` - 新機能追加
- `fix/` - バグ修正
- `docs/` - ドキュメント変更
- `refactor/` - リファクタリング
- `test/` - テスト追加・修正

例: `docs/add-git-workflow-rules`, `feature/user-registration`

### マージ戦略
- **squashマージを標準とする**（`git merge --squash`）
- 理由: 
  - 1機能=1コミットで履歴が整理される
  - mainブランチの履歴が読みやすい
  - ロールバックが容易

### コミット・プッシュ
- 小さく頻繁にコミット
- 1日1回以上mainへマージ
- マージ後は即座にブランチ削除

### コミット規約
- `feat:` 新機能
- `fix:` バグ修正
- `docs:` ドキュメント
- `test:` テスト追加・修正
- `refactor:` リファクタリング

### AI生成コードの明示
- Amazon Q Developerで生成したコミットには `🤖` を追加
- コミットメッセージ本文に「Generated-By: Amazon Q Developer」を記載

### テスト要件（MVP）
- 統合テスト: 主要APIエンドポイント
- ユニットテスト: 複雑なビジネスロジックのみ
- ❌ 100%カバレッジは不要

## 品質基準（MVP）

### コード品質
- Lombokを活用し、ボイラープレートを削減
- バリデーションは Bean Validation を使用
- 例外処理は GlobalExceptionHandler で統一

### API設計
- RESTful な URL 設計
- 適切な HTTP ステータスコード
- エラーレスポンスは統一フォーマット

### セキュリティ（最小限）
- パスワードは BCrypt でハッシュ化
- JWT トークンは24時間有効
- SQL インジェクション対策（JPA使用）
- ❌ 詳細な監査ログ（将来対応）
- ❌ トークンリフレッシュ（将来対応）

## MVP機能リスト

### Phase 1: 基盤（完了）
- ✅ ユーザー認証（signup, login, logout）

### Phase 2: 社員管理（次）
- 社員情報CRUD
- 社員一覧・検索（名前、組織、スキル）

### Phase 3: 組織・スキル
- 組織マスタCRUD
- スキルマスタCRUD
- 社員スキル登録

### Phase 4: 権限と可視化
- ロールベース権限チェック
- マネージャー配下メンバー一覧
- 人事向けスキル検索

### 将来対応（MVP外）
- スキル分析・レポート
- 詳細な監査ログ
- 複雑な権限カスタマイズ
- 社員履歴管理
- トークンリフレッシュ

## Governance

### 憲章の位置づけ
- この憲章はすべての開発判断の基準となる
- 機能追加時は憲章に照らして妥当性を確認
- 憲章に反する実装は原則として認めない

### 改訂プロセス
- 憲章の改訂は文書化し、理由を明記
- 既存機能への影響を評価
- 必要に応じて移行計画を策定

**Version**: 1.0.0-MVP | **Ratified**: 2025-10-28 | **Last Amended**: 2025-10-28
